@model Contabilidad.Models.VM.clsPlanVM
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<section class="content">
    <div class="row">
        <div class="col-md-6">
            <div class="box box-primary">
                <div class="box-header with-border">
                    <h3 class="box-title">Nueva Cuenta Contable</h3>
                    @*  <a class="btn btn-default btn-sm" href="#" onclick="showViewCreate();" data-toggle="tooltip" title="Nuevo"> <i class="glyphicon glyphicon-plus"></i></a>*@
                </div>

                <div class="box-body">
                    @using (Html.BeginForm())
                    {
                        using (Html.DevExtreme().ValidationGroup())
                        {
                            @Html.AntiForgeryToken();

                            @Html.HiddenFor(m => m.Nivel);
                            @Html.HiddenFor(m => m.CapituloId);
                            @Html.HiddenFor(m => m.PlanPadreId);

                            @(Html.DevExtreme().Form<Contabilidad.Models.VM.clsPlanVM>()
                                                                .ShowValidationSummary(true)
                                                                .Items(items =>
                                                                {
                                                                    items.AddGroup()
                                                                    .Items(groupItems =>
                                                                    {
                                                                        groupItems.AddSimpleFor(m => m.PlanCod).Editor(e => e.NumberBox().Format("####").Width("50%")).IsRequired(true);
                                                                        groupItems.AddSimpleFor(m => m.PlanDes).Editor(e => e.TextBox()).IsRequired(true);
                                                                        groupItems.AddSimpleFor(m => m.PlanEsp).Editor(e => e.TextArea());
                                                                        groupItems.AddSimpleFor(m => m.TipoPlanId).Editor(e => e.SelectBox().DataSource(d => d.Mvc().Controller("ComboBox").LoadAction("TipoPlanList").Key("TipoPlanId")).ValueExpr("TipoPlanId").DisplayExpr("TipoPlanDes").SearchEnabled(true).ShowClearButton(true).OnValueChanged("onValueChanged")).IsRequired(true);
                                                                        groupItems.AddSimpleFor(m => m.Orden).Editor(e => e.NumberBox().ShowSpinButtons(true).Step(1).Width("50%")).IsRequired(true);
                                                                        groupItems.AddSimpleFor(m => m.MonedaId).Editor(e => e.SelectBox().ID("Moneda").DataSource(d => d.Mvc().Controller("ComboBox").LoadAction("MonedaList").Key("MonedaId")).ValueExpr("MonedaId").DisplayExpr("MonedaDes").SearchEnabled(true).ShowClearButton(true)).IsRequired(true);
                                                                        groupItems.AddSimpleFor(m => m.TipoAmbitoId).Editor(e => e.SelectBox().ID("TipoAmbito").DataSource(d => d.Mvc().Controller("ComboBox").LoadAction("TipoAmbitoList").Key("TipoAmbitoId")).ValueExpr("TipoAmbitoId").DisplayExpr("TipoAmbitoDes").SearchEnabled(true).ShowClearButton(true)).IsRequired(true);
                                                                        groupItems.AddSimpleFor(m => m.EstadoId).Editor(e => e.SelectBox().DataSource(d => d.Mvc().Controller("ComboBox").LoadAction("EstadoList").Key("EstadoId")).ValueExpr("EstadoId").DisplayExpr("EstadoDes").SearchEnabled(true).ShowClearButton(true)).IsRequired(true);

                                                                        groupItems.AddEmpty();



                                                                    });
                                                                })
                                                                .FormData(Model)

                            )

                            <div Class="box-footer">
                                <Button type="submit" Class="btn btn-primary"><i Class="fa fa-floppy-o"></i></Button>
                                <a href="@Url.Action("Index", "Plan", new { idPlan = Model.PlanPadreId })" Class="btn btn-default"><i Class="fa fa-reply"></i></a>
                            </div>
                        }
                    }
                </div>
            </div>
        </div>
    </div>
</section>

@(Html.Partial("~/views/Error/InfoPopup.cshtml"))


<script>

    function onValueChanged(e) {
        if (e.value == 1) {
            $("#Moneda").dxSelectBox({ disabled: true, value: 0 });
            $("#TipoAmbito").dxSelectBox({ disabled: true, value: 0 });
        } else {
            $("#Moneda").dxSelectBox({ disabled: false, value: 0 });
            $("#TipoAmbito").dxSelectBox({ disabled: false, value: 0 });
        }

    }

</script>